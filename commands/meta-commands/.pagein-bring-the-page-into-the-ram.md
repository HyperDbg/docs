---
description: Description of the '.pagein' command in HyperDbg.
---

# .pagein (bring the page into the RAM)

### Command

> .pagein

### Syntax

> .pagein \[Mode (string)] \[VirtualAddress (hex)]

### Description

Injects a page-fault and brings the target page into the memory.

### Parameters

**\[Mode (string)] (optional)**

The page-fault error code that needs to be injected. The error code can be one of these values, or a combination of these values:

**p**: present&#x20;

**w**: write&#x20;

**u**: user&#x20;

**f**: fetch&#x20;

**k**: protection key&#x20;

**s**: shadow stack&#x20;

**h**: hlat&#x20;

**g**: sgx

**\[VirtualAddress (hex)]**

The **virtual** address of where we want to bring its entry into the RAM.

{% hint style="warning" %}
Currently, this command is only supported in the [Debugger Mode](https://docs.hyperdbg.org/using-hyperdbg/prerequisites/operation-modes#debugger-mode).
{% endhint %}

### Common Page-fault Codes

The following table is derived from [Exceptions](https://wiki.osdev.org/Exceptions) with some modifications, which explains the meaning of each bit in the **Mode** string.

<table data-header-hidden><thead><tr><th width="93">Bit</th><th width="79">Mode</th><th width="107">Length</th><th width="123">Name</th><th>Description</th></tr></thead><tbody><tr><td>P</td><td>p</td><td>1 bit</td><td>Present</td><td>When set, the page fault was caused by a page-protection violation. When not set, it was caused by a non-present page.</td></tr><tr><td>W</td><td>w</td><td>1 bit</td><td>Write</td><td>When set, the page fault was caused by a write access. When not set, it was caused by a read access.</td></tr><tr><td>U</td><td>u</td><td>1 bit</td><td>User</td><td>When set, the page fault was caused while CPL = 3. This does not necessarily mean that the page fault was a privilege violation.</td></tr><tr><td>RSVD</td><td></td><td>1 bit</td><td>Reserved write</td><td>When set, one or more page directory entries contain reserved bits which are set to 1. This only applies when the PSE or PAE flags in CR4 are set to 1.</td></tr><tr><td>I</td><td>f</td><td>1 bit</td><td>Instruction Fetch</td><td>When set, the page fault was caused by an instruction fetch. This only applies when the No-Execute bit is supported and enabled.</td></tr><tr><td>PK</td><td>k</td><td>1 bit</td><td>Protection key</td><td>When set, the page fault was caused by a protection-key violation. The PKRU register (for user-mode accesses) or PKRS MSR (for supervisor-mode accesses) specifies the protection key rights.</td></tr><tr><td>SS</td><td>s</td><td>1 bit</td><td>Shadow stack</td><td>When set, the page fault was caused by a shadow stack access.</td></tr><tr><td>HLAT</td><td>h</td><td>1 bit</td><td>HLAT</td><td>When set, there is no translation for the linear address using HLAT paging.</td></tr><tr><td>SGX</td><td>g</td><td>1 bit</td><td>Software Guard Extensions</td><td>When set, the fault was due to an <a href="https://en.wikipedia.org/wiki/Software_Guard_Extensions">SGX violation</a>. The fault is unrelated to ordinary paging.</td></tr></tbody></table>

This is a list of common page-fault error codes:



| Error Code | Mode      | Description                       |
| ---------- | --------- | --------------------------------- |
| 0x0        | (default) | page not-found                    |
| 0x2        | w         | write access fault                |
| 0x3        | pw        | present, write access fault       |
| 0x4        | u         | user access fault                 |
| 0x6        | wu        | write, user access fault          |
| 0x7        | pwu       | present, write, user access fault |
| 0x10       | f         | fetch instruction fault           |
| 0x11       | pf        | present, fetch instruction fault  |
| 0x14       | uf        | user, fetch instruction fault     |

### Examples

The following command injects a page-fault with the error code equal to `zero` and the **CR2** register is configured to `00007ff8349f2224`.

```diff
0: kHyperDbg> .pagein 00007ff8349f2224
the page-fault is delivered to the target thread
press 'g' to continue debuggee (the current thread will execute ONLY one instruction and will be halted again)...
```

The following command injects a page-fault with the error code equal to `0x4` and the **CR2** register is configured to `00007ff8349f2224`.

```diff
0: kHyperDbg> .pagein u 00007ff8349f2224
the page-fault is delivered to the target thread
press 'g' to continue debuggee (the current thread will execute ONLY one instruction and will be halted again)...
```

### IOCTL



### Remarks

{% hint style="success" %}
If the **VirtualAddress** and Value of entry for PDE and PTE from the kernel IOCTL are the same, the entry has a LARGE PDE and doesn't have PTE.
{% endhint %}

This command is guaranteed to keep debuggee in a halt state (in Debugger Mode); thus, nothing will change during its execution.

### Requirements

None

### Related

None
